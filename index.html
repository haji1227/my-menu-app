<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Menu</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; padding: 20px; padding-bottom: 120px; background: #f8f9fa; color: #2d3748; }
        .container { max-width: 800px; margin: 0 auto; }
        
        /* Typography */
        h1 { font-size: 1.5rem; text-align: center; margin-bottom: 20px; font-weight: 800; letter-spacing: -0.5px; }
        
        /* Calendar Grid */
        .calendar-grid {
            display: grid;
            gap: 15px;
            /* Responsive: 1 col on small, 2 cols on wide/fold */
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        }

        /* Day Card */
        .day-card { background: white; border-radius: 12px; border: 1px solid #e2e8f0; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        .day-header { 
            background: #edf2f7; padding: 10px 15px; font-weight: 700; color: #4a5568; 
            display: flex; justify-content: space-between; align-items: center;
        }
        .day-body { padding: 10px; min-height: 40px; }

        /* Dish Item */
        .dish-item { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 8px; margin-bottom: 6px; background: #fff; border-radius: 6px; border: 1px solid #f0f0f0;
        }
        .dish-info { display: flex; align-items: center; gap: 8px; overflow: hidden;}
        .dish-name { font-weight: 500; font-size: 0.95rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}
        .btn-link { 
            background: #ebf4ff; color: #4299e1; border: none; padding: 4px 8px; border-radius: 4px; 
            font-size: 0.75rem; text-decoration: none; font-weight: bold; flex-shrink: 0;
        }
        .btn-delete { background: none; border: none; color: #cbd5e0; cursor: pointer; font-size: 1.2rem; line-height: 1; padding: 0 5px;}
        .btn-delete:hover { color: #e53e3e; }

        /* Fixed Input Bar */
        .input-bar {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid #e2e8f0;
            padding: 15px;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.08);
            z-index: 100;
        }
        .input-row-main { display: flex; gap: 8px; max-width: 800px; margin: 0 auto; }
        .input-row-sub { display: none; margin-top: 10px; max-width: 800px; margin: 0 auto; animation: slideDown 0.2s ease-out; }
        
        select, input { padding: 12px; border: 1px solid #cbd5e0; border-radius: 8px; font-size: 16px; outline: none; background: white;}
        select { flex: 0 0 80px; font-weight: bold; }
        input { flex: 1; }
        
        .btn-icon { background: #edf2f7; border: none; border-radius: 8px; width: 44px; font-size: 1.2rem; cursor: pointer; color: #4a5568;}
        .btn-icon.active { background: #4299e1; color: white; }
        .btn-add { background: #2d3748; color: white; border: none; padding: 0 24px; border-radius: 8px; font-weight: bold; cursor: pointer;}
        
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h1>Weekly Menu üóìÔ∏è</h1>
        <button onclick="clearWeek()" style="color:#e53e3e; background:none; border:none; font-size:0.8rem;">Reset</button>
    </div>

    <div id="calendarView" class="calendar-grid"></div>
</div>

<div class="input-bar">
    <div class="input-row-main">
        <select id="daySelect">
            <option value="Mon">Mon</option>
            <option value="Tue">Tue</option>
            <option value="Wed">Wed</option>
            <option value="Thu">Thu</option>
            <option value="Fri">Fri</option>
            <option value="Sat">Sat</option>
            <option value="Sun">Sun</option>
        </select>
        <input type="text" id="dishName" placeholder="Dish Name...">
        <button class="btn-icon" onclick="toggleLinkInput()" id="linkToggleBtn">üìé</button>
        <button onclick="addDish()" class="btn-add">Add</button>
    </div>
    <div class="input-row-sub" id="linkInputRow">
        <input type="text" id="notionLink" placeholder="Paste Notion URL here...">
    </div>
</div>

<script>
    let planner = JSON.parse(localStorage.getItem('myMenuApp_planner')) || [];
    const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];

    function render() {
        const view = document.getElementById('calendarView');
        view.innerHTML = '';

        days.forEach(day => {
            const daysDishes = planner.filter(d => d.day === day);
            let dishesHtml = '';
            
            daysDishes.forEach(dish => {
                let linkBtn = dish.link ? `<a href="${dish.link}" target="_blank" class="btn-link">LINK ‚Üó</a>` : '';
                dishesHtml += `
                    <div class="dish-item">
                        <div class="dish-info">
                            <span class="dish-name">${dish.name}</span>
                            ${linkBtn}
                        </div>
                        <button onclick="removeDish(${dish.id})" class="btn-delete">√ó</button>
                    </div>
                `;
            });

            // Empty state
            if(daysDishes.length === 0) dishesHtml = '<div style="color:#cbd5e0; font-size:0.8rem; text-align:center; padding:10px;">-</div>';

            view.innerHTML += `
                <div class="day-card">
                    <div class="day-header">${day}</div>
                    <div class="day-body">${dishesHtml}</div>
                </div>
            `;
        });
    }

    function toggleLinkInput() {
        const row = document.getElementById('linkInputRow');
        const btn = document.getElementById('linkToggleBtn');
        if (row.style.display === 'block') {
            row.style.display = 'none';
            btn.classList.remove('active');
        } else {
            row.style.display = 'block';
            btn.classList.add('active');
        }
    }

    function addDish() {
        const day = document.getElementById('daySelect').value;
        const nameInput = document.getElementById('dishName');
        const linkInput = document.getElementById('notionLink');
        
        if(nameInput.value) {
            planner.push({
                id: Date.now(),
                day: day,
                name: nameInput.value,
                link: linkInput.value
            });
            save();
            render();
            nameInput.value = '';
            linkInput.value = '';
            // Don't close link input automatically, in case user adds multiple links
        }
    }

    function removeDish(id) {
        planner = planner.filter(d => d.id !== id);
        save();
        render();
    }

    function clearWeek() {
        if(confirm('Clear all?')) {
            planner = [];
            save();
            render();
        }
    }

    function save() {
        localStorage.setItem('myMenuApp_planner', JSON.stringify(planner));
    }

    render();
</script>

</body>
</html>
